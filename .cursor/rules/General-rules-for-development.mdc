---
alwaysApply: true
---

## Язык коммуникации
- Отвечай всегда на русском языке
- Технические термины можно на английском
- Комментарии в коде на русском

## Стиль кода
- Использовать строгую типизацию везде, где возможно
- Всегда добавлять PHPDoc к публичным методам
- Избегать магических чисел - использовать константы
- Называть переменные описательно, не использовать однобуквенные имена (кроме итераторов)

## Безопасность
- Никогда не хардкодить секреты, API ключи, пароли
- Всегда валидировать пользовательский ввод
- Использовать параметризованные запросы к БД
- Санитизировать вывод для предотвращения XSS

## Git commits
- Писать commit messages на русском языке
- Формат: "Тип: краткое описание"
- Типы: feat, fix, refactor, docs, style, test, chore

## Обработка ошибок
- Всегда обрабатывать исключения
- Логировать ошибки с контекстом
- Возвращать понятные сообщения об ошибках пользователю
- Не раскрывать внутренние детали в production

## Тестирование
- Покрывать критическую бизнес-логику тестами
- Использовать говорящие названия тестов
- Тесты должны быть независимыми друг от друга

## Документация
- Обновлять README при изменении установки/настройки
- Документировать сложную бизнес-логику
- Добавлять примеры использования API

## Рефакторинг
- Следовать принципам SOLID
- Избегать дублирования кода (DRY)
- Разделять ответственность (SRP)
- Предпочитать композицию наследованию

## Performance
- Оптимизировать только после измерения
- Избегать преждевременной оптимизации
- Использовать кэширование разумно
- Минимизировать запросы к БД
```

## Правила для PHP проектов

```markdown
# PHP специфичные правила

## Версия и стандарты
- Минимальная версия PHP 8.1+
- Следовать PSR-12 для стиля кода
- Использовать строгую типизацию: `declare(strict_types=1);`

## Именование
- Классы: PascalCase
- Методы и свойства: camelCase
- Константы: UPPER_SNAKE_CASE
- Namespaces: соответствуют структуре папок

## Composer
- Всегда указывать версии зависимостей
- Использовать семантическое версионирование
- Разделять dev и production зависимости

## Laravel/Eloquent
- Использовать миграции для изменений БД
- Не писать сырой SQL, использовать Query Builder
- Eager loading для избежания N+1
- Использовать аксессоры/мутаторы для трансформации данных
```

## Правила для работы с БД

```markdown
# Работа с базами данных

## Проектирование
- Нормализовать данные (обычно 3NF)
- Использовать правильные типы данных
- Добавлять индексы на часто используемые поля
- Использовать внешние ключи для целостности

## Запросы
- Избегать SELECT *
- Использовать LIMIT для больших выборок
- Профилировать медленные запросы
- Использовать транзакции где нужно

## Миграции
- Именовать описательно
- Всегда писать метод down() для отката
- Не изменять старые миграции в production
- Тестировать миграции на копии БД
```

## Правила для API разработки

```markdown
# REST API разработка

## Дизайн API
- Использовать существительные в URL, не глаголы
- Множественное число для коллекций
- Версионирование API (/api/v1/)
- Использовать правильные HTTP методы

## Ответы
- Возвращать правильные HTTP статусы
- Единообразный формат ответов
- Включать сообщения об ошибках
- Документировать все эндпоинты

## Аутентификация
- Использовать JWT или OAuth2
- Не передавать секреты в URL
- Использовать HTTPS обязательно
- Реализовать rate limiting

## Валидация
- Валидировать все входные данные
- Возвращать понятные ошибки валидации
- Санитизировать данные
- Проверять права доступа
```

## Правила для Docker проектов

```markdown
# Docker и контейнеризация

## Dockerfile
- Использовать официальные базовые образы
- Минимизировать количество слоёв
- Использовать .dockerignore
- Не хранить секреты в образах

## docker-compose
- Использовать переменные окружения
- Volumes для персистентных данных
- Networks для изоляции
- Health checks для сервисов

## Безопасность
- Запускать контейнеры от не-root пользователя
- Обновлять базовые образы регулярно
- Сканировать образы на уязвимости
- Ограничивать ресурсы контейнеров
```
