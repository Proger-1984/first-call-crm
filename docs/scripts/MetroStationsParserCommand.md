# MetroStationsParserCommand

## Назначение
Скрипт парсит информацию о станциях метро из API HeadHunter (hh.ru) и сохраняет данные в базу данных.

## Расположение файла
`src/Commands/MetroStationsParserCommand.php`

## Описание функциональности
Скрипт выполняет следующие действия:
1. Загружает список локаций (городов) из базы данных
2. Для каждой локации определяет ID города в API HeadHunter
3. Отправляет запрос к API HeadHunter для получения данных о станциях метро
4. Обрабатывает полученные данные: линии метро и станции
5. Сохраняет информацию о станциях метро в базу данных

## Запуск скрипта
```bash
php bin/console parse-metro-stations
```

## Запуск по расписанию
Скрипт запускается автоматически каждую ночь в 3:00 через cron. Запись в crontab выглядит следующим образом:

```bash
0 3 * * * /usr/bin/supervisorctl start parse-metro-stations
```

## Таблицы в базе данных
Скрипт работает с двумя таблицами:
- `locations` - таблица с локациями (городами)
- `metro_stations` - таблица для хранения информации о станциях метро

### Структура таблицы metro_stations
| Поле | Описание |
|------|----------|
| location_id | ID локации (города) |
| name | Название станции метро |
| line | Название линии метро |
| color | Цвет линии в HEX-формате |
| lat | Широта расположения станции |
| lng | Долгота расположения станции |

## Поддерживаемые города
Скрипт поддерживает следующие города:
- Москва (ID: 1)
- Санкт-Петербург (ID: 2)
- Екатеринбург (ID: 3)
- Новосибирск (ID: 4)
- Нижний Новгород (ID: 66)
- Самара (ID: 78)
- Казань (ID: 88)

## Логирование
Скрипт использует сервис LogService для логирования следующих событий:
- Запуск и успешное завершение парсинга
- Количество загруженных локаций
- Парсинг станций метро для конкретного города
- Добавление станций метро в базу данных
- Предупреждения о существующих станциях
- Ошибки при выполнении скрипта

Файлы логов сохраняются с тегом 'parse-metro-stations'.
