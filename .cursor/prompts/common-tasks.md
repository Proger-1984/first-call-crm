# Готовые промпты для First Call API

Используйте эти промпты для типичных задач в проекте.

## Создание нового эндпоинта

```
Создай новый эндпоинт для [описание функционала]:
- Метод: GET/POST/PUT/DELETE
- URL: /api/v1/[путь]
- Защищённость: требует/не требует авторизации
- Формат ответа: [описание]

Следуй архитектуре проекта:
1. Контроллер в src/Controllers/
2. Сервис в src/Services/ (зарегистрировать в bootstrap/container.php)
3. Маршрут в routes/routes.php
4. Используй ResponseTrait для ответов
5. Добавь валидацию через приватный метод
```

## Создание новой модели

```
Создай модель для таблицы [название_таблицы]:
- Поля: [список полей с типами]
- Связи: [описание связей с другими моделями]

Требования:
1. Полный PHPDoc с @property, @property-read, @method
2. $fillable для массового присваивания
3. $casts для приведения типов
4. $hidden для чувствительных данных
5. Методы для связей (BelongsTo, HasMany и т.д.)
```

## Создание миграции

```
Создай миграцию для [описание]:
- Название файла: YYYYMMDDHHMMSS_[описание].php
- Создать/изменить таблицу: [название]
- Поля: [список с типами и индексами]
- Внешние ключи: [если есть]

Не забудь:
1. Timestamps (created_at, updated_at)
2. Индексы на внешних ключах
3. Правильные типы данных для PostgreSQL
```

## Добавление middleware

```
Создай middleware для [описание назначения]:
- Название: [Name]Middleware
- Логика: [описание проверок/трансформаций]

Требования:
1. Реализовать MiddlewareInterface
2. Метод process(Request, RequestHandler): Response
3. Добавить к маршрутам через ->add()
```

## Рефакторинг контроллера

```
Отрефактори контроллер [название]:
- Вынеси бизнес-логику в сервис
- Оставь только валидацию и формирование ответов
- Используй ResponseTrait
- Оберни всё в try-catch
- Добавь валидацию через приватный метод validate*Data()
```

## Добавление Telegram уведомления

```
Добавь Telegram уведомление для события [описание]:
- Получатель: пользователь/администратор
- Содержание: [описание сообщения]
- Триггер: [когда отправлять]

Используй TelegramService::sendMessage() или создай новый метод notify*()
```

## Оптимизация запроса к БД

```
Оптимизируй запрос в [файл]:
- Используй eager loading (with()) для связей
- Избегай N+1 проблемы
- Добавь индексы если нужно
- Используй select() для выбора только нужных полей
```

## Добавление валидации

```
Добавь валидацию для эндпоинта [название]:
- Обязательные поля: [список]
- Опциональные поля: [список]
- Типы данных: [описание]
- Правила валидации: [min/max/format и т.д.]

Создай приватный метод validate*Data() в контроллере
```

## Исправление бага

```
Исправь баг в [файл/функция]:
- Описание проблемы: [что не работает]
- Ожидаемое поведение: [как должно быть]
- Текущее поведение: [что происходит сейчас]

Проанализируй код, найди причину и исправь согласно архитектуре проекта
```

## Написание тестов

```
Напиши PHPUnit тесты для [функционал]:
- Тестируемый класс: [название]
- Сценарии: [список тест-кейсов]

Покрой:
1. Успешные сценарии
2. Граничные случаи
3. Обработку ошибок
```

## Добавление логирования

```
Добавь логирование в [файл]:
- События для логирования: [список]
- Уровень: error/warning/info/debug
- Контекст: [какие данные логировать]

Используй LogService с методами error(), warning(), info(), debug()
```

## Создание API документации

```
Создай/обнови OpenAPI документацию для эндпоинта [путь]:
- Метод: [GET/POST/PUT/DELETE]
- Параметры: [описание]
- Тело запроса: [схема]
- Ответы: [коды и схемы]

Файл: docs/api/openapi.yaml
```

## Оптимизация производительности

```
Оптимизируй производительность [компонент]:
- Профилируй узкие места
- Добавь кэширование где нужно
- Оптимизируй запросы к БД
- Используй индексы
- Проверь N+1 проблемы
```

## Добавление административного функционала

```
Добавь административный функционал для [описание]:
- URL: /api/v1/admin/[путь]
- Проверка роли: checkAdminAccess()
- Функционал: [описание действий]

Не забудь:
1. Проверку прав через userRole
2. Логирование действий админа
3. Уведомления если нужны
```

## Интеграция с внешним сервисом

```
Создай интеграцию с [название сервиса]:
- Назначение: [для чего нужна]
- API endpoint: [URL]
- Аутентификация: [метод]

Создай сервис в src/Services/ с методами для работы с API
Используй GuzzleHTTP для запросов
```

## Рефакторинг базы данных

```
Отрефактори структуру БД для [описание]:
- Текущая проблема: [что не так]
- Предлагаемое решение: [как улучшить]

Создай миграцию с изменениями:
1. Изменение структуры таблиц
2. Миграция данных (если нужна)
3. Откат (down метод)
```
